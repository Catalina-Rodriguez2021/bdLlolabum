TABLAS: 
	CREATE TABLE CLIENTE (
	ID_CLIENTE INT IDENTITY(1,1) PRIMARY KEY NOT NULL, 
    	ID_PERSONA INT NOT NULL,
    	USUARIO VARCHAR(50) NOT NULL,
    	CONTRASENA VARCHAR(50) NOT NULL,
	ESTADO BIT NOT NULL
	);

    	CREATE TABLE PERSONA (
    	ID_PERSONA INT IDENTITY(1,1) PRIMARY KEY NOT NULL,
    	IDENTIFICACION INT NOT NULL,
	NOMBRE_1 VARCHAR(50)NOT NULL, 
	NOMBRE_2 VARCHAR(50)NULL, 
	APELLIDO_1 VARCHAR(50)NOT NULL, 
	APELLIDO_2 VARCHAR(50)NULL,
	EDAD INT NOT NULL,
	CORREO VARCHAR(50)NULL,
	TELEFONO INT NULL,
	ESTADO BIT NOT NULL	
    );

	CREATE TABLE EMPLEADO (
	ID_EMPLEADO INT IDENTITY(1,1) PRIMARY KEY NOT NULL,
    	ID_PERSONA INT NOT NULL,
    	USUARIO VARCHAR(50) NOT NULL,
    	CONTRASENA VARCHAR(50) NOT NULL,
	ESTADO BIT NOT NULL
	);


	CREATE TABLE INTENCION_COMPRA (
	ID_INTENCION_COMPRA INT IDENTITY(1,1) PRIMARY KEY NOT NULL, 
	DESCRIPCION_INTENCION_COMPRA VARCHAR(50)NOT NULL, 
	ID_CLIENTE INT NOT NULL,
	ID_VEHICULOS INT NOT NULL,
	ID_FACTURA INT NOT NULL,
	ESTADO BIT NOT NULL
	);
	 
	CREATE TABLE FACTURA (
	ID_FACTURA INT IDENTITY(1,1) PRIMARY KEY NOT NULL,  
	FECHA_FACTURA DATE NOT NULL,
    	ESTADO_FACTURA BIT NOT NULL,
	ESTADO BIT NOT NULL
	);


	CREATE TABLE VEHICULOS (
	ID_VEHICULOS INT IDENTITY(1,1) PRIMARY KEY NOT NULL,  
	NOMBRE VARCHAR(50)NOT NULL,
	PRECIO INT NOT NULL, 
	ID_CATEGORIA INT NULL, 
	ID_CONCESIONARIO INT NULL,
	ESTADO BIT NOT NULL
	);


	CREATE TABLE CATEGORIA (
	ID_CATEGORIA INT IDENTITY(1,1) PRIMARY KEY NOT NULL, 
	NOMBRE VARCHAR(50)NOT NULL,
	ESTADO BIT NOT NULL
	);


	CREATE TABLE CONCESCIONARIO (
	ID_CONCESIONARIO INT IDENTITY(1,1) PRIMARY KEY NOT NULL, 
	NOMBRE VARCHAR(50)NOT NULL,
	DIRECCION VARCHAR(50)NOT NULL, 
	TELEFONO INT NULL,
	EMAIL VARCHAR(60) NULL,
	ESTADO BIT NOT NULL
	);


ALTER TABLE INTENCION_COMPRA ADD CONSTRAINT PK_ID_VEHICULOS FOREIGN KEY (ID_VEHICULOS) REFERENCES VEHICULOS (ID_VEHICULOS);
ALTER TABLE INTENCION_COMPRA ADD CONSTRAINT PK_ID_FACTURA FOREIGN KEY (ID_FACTURA) REFERENCES FACTURA (ID_FACTURA);
ALTER TABLE VEHICULOS ADD CONSTRAINT PK_ID_CATEGORIA FOREIGN KEY (ID_CATEGORIA) REFERENCES CATEGORIA (ID_CATEGORIA);
ALTER TABLE VEHICULOS ADD CONSTRAINT PK_ID_CONCESIONARIO FOREIGN KEY (ID_CONCESIONARIO) REFERENCES CONCESCIONARIO (ID_CONCESIONARIO);
ALTER TABLE INTENCION_COMPRA ADD CONSTRAINT PK_ID_CLIENTE FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTE (ID_CLIENTE);
ALTER TABLE CLIENTE ADD CONSTRAINT PK_ID_PERSONA_CLIENTE FOREIGN KEY (ID_PERSONA) REFERENCES PERSONA (ID_PERSONA);
ALTER TABLE EMPLEADO ADD CONSTRAINT PK_ID_PERSONA_EMPLEADO FOREIGN KEY (ID_PERSONA) REFERENCES PERSONA (ID_PERSONA);




CREATE VIEW VistaINTENCION_COMPRAConDatos AS
SELECT
    P.ID_INTENCION_COMPRA,
    P.DESCRIPCION_INTENCION_COMPRA,
    PE.ID_PERSONA AS ID_CLIENTE,
    PE.NOMBRE_1 AS CLIENTE_NOMBRE,
    PE.APELLIDO_1 AS CLIENTE_APELLIDO,
    V.ID_VEHICULOS,
    V.NOMBRE AS VEHICULO_NOMBRE,
    V.PRECIO AS VEHICULO_PRECIO,
    CO.ID_CONCESIONARIO,
    CO.NOMBRE AS CONCESIONARIO_NOMBRE,
    CO.DIRECCION AS CONCESIONARIO_DIRECCION,
	F.ID_FACTURA,
	F.FECHA_FACTURA
FROM
    ID_INTENCION_COMPRA P
JOIN
    VEHICULOS V ON P.ID_VEHICULOS = V.ID_VEHICULOS
JOIN
    CONCESCIONARIO CO ON V.ID_CONCESIONARIO = CO.ID_CONCESIONARIO
JOIN
    FACTURA F ON P.ID_FACTURA = F.ID_FACTURA
JOIN
    CLIENTE CL ON P.ID_CLIENTE = CL.ID_CLIENTE
JOIN
    PERSONA PE ON CL.ID_PERSONA = PE.ID_PERSONA;



CREATE VIEW VistaEmpleadoConDatos AS
SELECT
    E.ID_EMPLEADO,
    E.USUARIO,
    E.CONTRASENA,
    PE.ID_PERSONA,
    PE.NOMBRE_1 AS EMPLEADO_NOMBRE,
    PE.APELLIDO_1 AS EMPLEADO_APELLIDO
FROM
    EMPLEADO E
JOIN
    PERSONA PE ON E.ID_PERSONA = PE.ID_PERSONA;



CREATE VIEW VistaClienteConDatos AS
SELECT
    C.ID_CLIENTE,
    C.USUARIO,
    C.CONTRASENA,
    PE.ID_PERSONA,
    PE.NOMBRE_1 AS CLIENTE_NOMBRE,
    PE.APELLIDO_1 AS CLIENTE_APELLIDO
FROM
    CLIENTE C
JOIN
    PERSONA PE ON C.ID_PERSONA = PE.ID_PERSONA;
